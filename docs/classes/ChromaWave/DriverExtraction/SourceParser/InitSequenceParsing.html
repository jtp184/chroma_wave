<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang='en'>
<head>
<title>ChromaWave::DriverExtraction::SourceParser::InitSequenceParsing</title>
<meta name='viewport' content='width=device-width, initial-scale=1'>
<meta content='text/html; charset=UTF-8' http-equiv='Content-Type'>
<link href='../../../../css/style.css' media='screen' rel='stylesheet' type='text/css'>
<script type='text/javascript'>
  function popupCode(url) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }
  
  function toggleCode(id) {
    var code = document.getElementById(id)
  
    code.style.display = code.style.display != 'block' ? 'block' : 'none'
    return true
  }
  
  // Make codeblocks hidden by default
  document.writeln('<' + 'style type="text/css">.method .source pre { display: none }<\/style>')
</script>
</head>
<body class='page'>
<div class='class' id='wrapper'>
<div class='header'>
<h1 class='name'><span class='type'>module</span>
ChromaWave::DriverExtraction::SourceParser::InitSequenceParsing
</h1>
<ol class='paths'>
<li>
<a href="../../../../files/lib/chroma_wave/driver_extraction/source_parser/init_sequence_parsing_rb.html">lib/chroma_wave/driver_extraction/source_parser/init_sequence_parsing.rb</a>
</li>
</ol>
</div>
<div id='content'>
<div id='text'>
<div id='description'>
<p>Methods for extracting init sequences from C source files.</p>

<p>Handles parsing of Init, Init_Fast, and Init_Partial function bodies into encoded byte sequences. Uses {InitParseState} to track command/data accumulation during line-by-line traversal.</p>
</div>
<div id='method-list'>
<h2>Methods</h2>
<h3>Private Instance</h3>
<ol>
<li><a href="#method-i-classify_sw_reset_line">classify_sw_reset_line</a></li>
<li><a href="#method-i-dispatch_init_line">dispatch_init_line</a></li>
<li><a href="#method-i-emit_busy_match">emit_busy_match</a></li>
<li><a href="#method-i-emit_command_match">emit_command_match</a></li>
<li><a href="#method-i-emit_data_match">emit_data_match</a></li>
<li><a href="#method-i-emit_misc_match">emit_misc_match</a></li>
<li><a href="#method-i-emit_sentinel_match">emit_sentinel_match</a></li>
<li><a href="#method-i-extract_all_inits">extract_all_inits</a></li>
<li><a href="#method-i-extract_init_sequence">extract_init_sequence</a></li>
<li><a href="#method-i-find_init_sequence">find_init_sequence</a></li>
<li><a href="#method-i-init_patterns">init_patterns</a></li>
<li><a href="#method-i-partial_init_patterns">partial_init_patterns</a></li>
<li><a href="#method-i-skip_init_line-3F">skip_init_line?</a></li>
<li><a href="#method-i-sw_reset_context-3F">sw_reset_context?</a></li>
</ol>
</div>
<div id='context'>
<div id='includes'>
<h2>Included modules</h2>
<ol>
<li><a href="../Opcodes.html">Opcodes</a></li>
<li><a href="../Patterns.html">Patterns</a></li>
</ol>
</div>
</div>
<div id='section'>
<div id='methods'>
<h2>Private Instance methods</h2>
<div class='method private-instance' id='method-method-i-classify_sw_reset_line'>
<a name='method-i-classify_sw_reset_line'></a>
<div class='synopsis'>
<span class='name'>classify_sw_reset_line</span><span class='arguments'>(stripped)</span>

</div>
<div class='description'>

<p>Classifies a line as decisive for SW reset context.</p>

<p>@param stripped [String] stripped line @return [true, false, nil] true=SWRESET, false=REFRESH, nil=keep looking</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-classify_sw_reset_line-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-classify_sw_reset_line-source'><span class="ruby-comment"># File lib/chroma_wave/driver_extraction/source_parser/init_sequence_parsing.rb, line 175</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">classify_sw_reset_line</span>(<span class="ruby-identifier">stripped</span>)
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">nil</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">stripped</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">stripped</span>.<span class="ruby-identifier">start_with?</span>(<span class="ruby-string">&#39;//&#39;</span>)
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">true</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">stripped</span>.<span class="ruby-identifier">match?</span>(<span class="ruby-regexp">/ReadBusy|WaitUntilIdle|BusyHigh/</span>)
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">stripped</span>.<span class="ruby-identifier">match?</span>(<span class="ruby-regexp">/SendData|for\s*\(/</span>)

  <span class="ruby-identifier">stripped</span>.<span class="ruby-identifier">match?</span>(<span class="ruby-regexp">/SendCommand/</span>) <span class="ruby-operator">||</span> <span class="ruby-keyword">nil</span>
<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method private-instance' id='method-method-i-dispatch_init_line'>
<a name='method-i-dispatch_init_line'></a>
<div class='synopsis'>
<span class='name'>dispatch_init_line</span><span class='arguments'>(stripped, remaining, state)</span>

</div>
<div class='description'>

<p>Attempts each init-line handler in priority order.</p>

<p>@param stripped [String] stripped line text @param remaining [Array&lt;String&gt;] remaining lines @param state [InitParseState] parse state @return [void]</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-dispatch_init_line-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-dispatch_init_line-source'><span class="ruby-comment"># File lib/chroma_wave/driver_extraction/source_parser/init_sequence_parsing.rb, line 96</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">dispatch_init_line</span>(<span class="ruby-identifier">stripped</span>, <span class="ruby-identifier">remaining</span>, <span class="ruby-identifier">state</span>)
  <span class="ruby-identifier">emit_sentinel_match</span>(<span class="ruby-identifier">stripped</span>, <span class="ruby-identifier">state</span>) <span class="ruby-operator">||</span> <span class="ruby-identifier">emit_busy_match</span>(<span class="ruby-identifier">stripped</span>, <span class="ruby-identifier">state</span>) <span class="ruby-operator">||</span>
    <span class="ruby-identifier">emit_command_match</span>(<span class="ruby-identifier">stripped</span>, <span class="ruby-identifier">remaining</span>, <span class="ruby-identifier">state</span>) <span class="ruby-operator">||</span>
    <span class="ruby-identifier">emit_data_match</span>(<span class="ruby-identifier">stripped</span>, <span class="ruby-identifier">state</span>) <span class="ruby-operator">||</span> <span class="ruby-identifier">emit_misc_match</span>(<span class="ruby-identifier">stripped</span>, <span class="ruby-identifier">state</span>)
<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method private-instance' id='method-method-i-emit_busy_match'>
<a name='method-i-emit_busy_match'></a>
<div class='synopsis'>
<span class='name'>emit_busy_match</span><span class='arguments'>(stripped, state)</span>

</div>
<div class='description'>

<p>Emits a busy-wait sentinel if the line matches.</p>

<p>@param stripped [String] stripped line text @param state [InitParseState] parse state @return [Boolean, nil]</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-emit_busy_match-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-emit_busy_match-source'><span class="ruby-comment"># File lib/chroma_wave/driver_extraction/source_parser/init_sequence_parsing.rb, line 122</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">emit_busy_match</span>(<span class="ruby-identifier">stripped</span>, <span class="ruby-identifier">state</span>)
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">nil</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">stripped</span>.<span class="ruby-identifier">match?</span>(<span class="ruby-constant">READ_BUSY_RE</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">stripped</span>.<span class="ruby-identifier">match?</span>(<span class="ruby-constant">SEND_COMMAND_RE</span>)

  <span class="ruby-identifier">state</span>.<span class="ruby-identifier">emit_sentinel</span>(<span class="ruby-constant">SEQ_WAIT_BUSY</span>)
  <span class="ruby-keyword">true</span>
<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method private-instance' id='method-method-i-emit_command_match'>
<a name='method-i-emit_command_match'></a>
<div class='synopsis'>
<span class='name'>emit_command_match</span><span class='arguments'>(stripped, remaining, state)</span>

</div>
<div class='description'>

<p>Processes a SendCommand match.</p>

<p>@param stripped [String] stripped line text @param remaining [Array&lt;String&gt;] remaining lines @param state [InitParseState] parse state @return [Boolean, nil]</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-emit_command_match-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-emit_command_match-source'><span class="ruby-comment"># File lib/chroma_wave/driver_extraction/source_parser/init_sequence_parsing.rb, line 135</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">emit_command_match</span>(<span class="ruby-identifier">stripped</span>, <span class="ruby-identifier">remaining</span>, <span class="ruby-identifier">state</span>)
  <span class="ruby-identifier">match</span> = <span class="ruby-identifier">stripped</span>.<span class="ruby-identifier">match</span>(<span class="ruby-constant">SEND_COMMAND_RE</span>)
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">nil</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">match</span>

  <span class="ruby-identifier">cmd_byte</span> = <span class="ruby-constant">Integer</span>(<span class="ruby-identifier">match</span>[<span class="ruby-value">1</span>])
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">cmd_byte</span> <span class="ruby-operator">==</span> <span class="ruby-value">0x12</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">sw_reset_context?</span>(<span class="ruby-identifier">remaining</span>)
    <span class="ruby-identifier">state</span>.<span class="ruby-identifier">emit_sentinel</span>(<span class="ruby-constant">SEQ_SW_RESET</span>)
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">state</span>.<span class="ruby-identifier">start_command</span>(<span class="ruby-identifier">cmd_byte</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">true</span>
<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method private-instance' id='method-method-i-emit_data_match'>
<a name='method-i-emit_data_match'></a>
<div class='synopsis'>
<span class='name'>emit_data_match</span><span class='arguments'>(stripped, state)</span>

</div>
<div class='description'>

<p>Processes SendData or Delay matches.</p>

<p>@param stripped [String] stripped line text @param state [InitParseState] parse state @return [Boolean, nil]</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-emit_data_match-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-emit_data_match-source'><span class="ruby-comment"># File lib/chroma_wave/driver_extraction/source_parser/init_sequence_parsing.rb, line 153</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">emit_data_match</span>(<span class="ruby-identifier">stripped</span>, <span class="ruby-identifier">state</span>)
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">m</span> = <span class="ruby-identifier">stripped</span>.<span class="ruby-identifier">match</span>(<span class="ruby-constant">SEND_DATA_RE</span>)) <span class="ruby-keyword">then</span> <span class="ruby-identifier">state</span>.<span class="ruby-identifier">add_data</span>(<span class="ruby-constant">Integer</span>(<span class="ruby-identifier">m</span>[<span class="ruby-value">1</span>]))
  <span class="ruby-keyword">elsif</span> (<span class="ruby-identifier">m</span> = <span class="ruby-identifier">stripped</span>.<span class="ruby-identifier">match</span>(<span class="ruby-constant">DELAY_RE</span>)) <span class="ruby-keyword">then</span> <span class="ruby-identifier">state</span>.<span class="ruby-identifier">encode_delay</span>(<span class="ruby-identifier">m</span>[<span class="ruby-value">1</span>].<span class="ruby-identifier">to_i</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">m</span> <span class="ruby-operator">?</span> <span class="ruby-keyword">true</span> <span class="ruby-operator">:</span> <span class="ruby-keyword">nil</span>
<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method private-instance' id='method-method-i-emit_misc_match'>
<a name='method-i-emit_misc_match'></a>
<div class='synopsis'>
<span class='name'>emit_misc_match</span><span class='arguments'>(stripped, state)</span>

</div>
<div class='description'>

<p>Processes LUT calls and SetWindow matches.</p>

<p>@param stripped [String] stripped line text @param state [InitParseState] parse state @return [Boolean, nil]</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-emit_misc_match-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-emit_misc_match-source'><span class="ruby-comment"># File lib/chroma_wave/driver_extraction/source_parser/init_sequence_parsing.rb, line 165</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">emit_misc_match</span>(<span class="ruby-identifier">stripped</span>, <span class="ruby-identifier">state</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">stripped</span>.<span class="ruby-identifier">match?</span>(<span class="ruby-constant">LUT_CALL_RE</span>) <span class="ruby-keyword">then</span> <span class="ruby-identifier">state</span>.<span class="ruby-identifier">flush_and_reset</span>
  <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">stripped</span>.<span class="ruby-identifier">match?</span>(<span class="ruby-regexp">/SetWindows|SetWindow/</span>) <span class="ruby-keyword">then</span> <span class="ruby-identifier">state</span>.<span class="ruby-identifier">emit_sentinel</span>(<span class="ruby-constant">SEQ_SET_WINDOW</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method private-instance' id='method-method-i-emit_sentinel_match'>
<a name='method-i-emit_sentinel_match'></a>
<div class='synopsis'>
<span class='name'>emit_sentinel_match</span><span class='arguments'>(stripped, state)</span>

</div>
<div class='description'>

<p>Emits a sentinel if the line matches a sentinel pattern.</p>

<p>@param stripped [String] stripped line text @param state [InitParseState] parse state @return [Boolean, nil]</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-emit_sentinel_match-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-emit_sentinel_match-source'><span class="ruby-comment"># File lib/chroma_wave/driver_extraction/source_parser/init_sequence_parsing.rb, line 107</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">emit_sentinel_match</span>(<span class="ruby-identifier">stripped</span>, <span class="ruby-identifier">state</span>)
  <span class="ruby-constant">INIT_SENTINEL_PATTERNS</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">pattern</span>, <span class="ruby-identifier">sentinel</span><span class="ruby-operator">|</span>
    <span class="ruby-keyword">next</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">stripped</span>.<span class="ruby-identifier">match?</span>(<span class="ruby-identifier">pattern</span>)

    <span class="ruby-identifier">state</span>.<span class="ruby-identifier">emit_sentinel</span>(<span class="ruby-identifier">sentinel</span>)
    <span class="ruby-keyword">return</span> <span class="ruby-keyword">true</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">nil</span>
<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method private-instance' id='method-method-i-extract_all_inits'>
<a name='method-i-extract_all_inits'></a>
<div class='synopsis'>
<span class='name'>extract_all_inits</span><span class='arguments'>(header_data)</span>

</div>
<div class='description'>

<p>Extracts all init sequences for the model.</p>

<p>@param header_data [Hash] header data @return [Hash] init, fast, and partial sequences</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-extract_all_inits-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-extract_all_inits-source'><span class="ruby-comment"># File lib/chroma_wave/driver_extraction/source_parser/init_sequence_parsing.rb, line 21</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">extract_all_inits</span>(<span class="ruby-identifier">header_data</span>)
  <span class="ruby-identifier">escaped</span> = <span class="ruby-constant">Regexp</span>.<span class="ruby-identifier">escape</span>(<span class="ruby-ivar">@prefix</span>)
  {
    <span class="ruby-value">init_seq:</span> <span class="ruby-identifier">find_init_sequence</span>(<span class="ruby-identifier">init_patterns</span>, <span class="ruby-identifier">header_data</span>),
    <span class="ruby-value">init_fast_seq:</span> <span class="ruby-identifier">extract_init_sequence</span>(<span class="ruby-regexp">/#{escaped}_?Init_Fast/</span>, <span class="ruby-identifier">header_data</span>),
    <span class="ruby-value">init_partial_seq:</span> <span class="ruby-identifier">find_init_sequence</span>(<span class="ruby-identifier">partial_init_patterns</span>, <span class="ruby-identifier">header_data</span>)
  }
<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method private-instance' id='method-method-i-extract_init_sequence'>
<a name='method-i-extract_init_sequence'></a>
<div class='synopsis'>
<span class='name'>extract_init_sequence</span><span class='arguments'>(func_pattern, _header_data)</span>

</div>
<div class='description'>

<p>Parses an Init function body into an encoded init sequence.</p>

<p>@param func_pattern [Regexp] function name pattern @param _header_data [Hash] unused, kept for API consistency @return [Array&lt;Integer&gt;, nil] encoded init sequence or nil</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-extract_init_sequence-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-extract_init_sequence-source'><span class="ruby-comment"># File lib/chroma_wave/driver_extraction/source_parser/init_sequence_parsing.rb, line 68</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">extract_init_sequence</span>(<span class="ruby-identifier">func_pattern</span>, <span class="ruby-identifier">_header_data</span>)
  <span class="ruby-identifier">init_fn</span> = <span class="ruby-identifier">extract_function_body</span>(<span class="ruby-ivar">@c_content</span>, <span class="ruby-identifier">func_pattern</span>)
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">nil</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">init_fn</span>

  <span class="ruby-identifier">state</span> = <span class="ruby-constant">InitParseState</span>.<span class="ruby-identifier">new</span>
  <span class="ruby-identifier">init_fn</span>.<span class="ruby-identifier">lines</span>.<span class="ruby-identifier">each_with_index</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">line</span>, <span class="ruby-identifier">idx</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">stripped</span> = <span class="ruby-identifier">line</span>.<span class="ruby-identifier">strip</span>
    <span class="ruby-identifier">dispatch_init_line</span>(<span class="ruby-identifier">stripped</span>, <span class="ruby-identifier">init_fn</span>.<span class="ruby-identifier">lines</span>[(<span class="ruby-identifier">idx</span> <span class="ruby-operator">+</span> <span class="ruby-value">1</span>)<span class="ruby-operator">..</span>], <span class="ruby-identifier">state</span>) <span class="ruby-keyword">unless</span> <span class="ruby-identifier">skip_init_line?</span>(<span class="ruby-identifier">stripped</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">state</span>.<span class="ruby-identifier">finalize</span>
<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method private-instance' id='method-method-i-find_init_sequence'>
<a name='method-i-find_init_sequence'></a>
<div class='synopsis'>
<span class='name'>find_init_sequence</span><span class='arguments'>(patterns, header_data)</span>

</div>
<div class='description'>

<p>Finds the first matching init sequence from a list of patterns.</p>

<p>@param patterns [Array&lt;Regexp&gt;] patterns to try @param header_data [Hash] header data @return [Array&lt;Integer&gt;, nil]</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-find_init_sequence-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-find_init_sequence-source'><span class="ruby-comment"># File lib/chroma_wave/driver_extraction/source_parser/init_sequence_parsing.rb, line 56</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">find_init_sequence</span>(<span class="ruby-identifier">patterns</span>, <span class="ruby-identifier">header_data</span>)
  <span class="ruby-identifier">patterns</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">pat</span><span class="ruby-operator">|</span>
    (<span class="ruby-identifier">seq</span> = <span class="ruby-identifier">extract_init_sequence</span>(<span class="ruby-identifier">pat</span>, <span class="ruby-identifier">header_data</span>)) <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-keyword">return</span> <span class="ruby-identifier">seq</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">nil</span>
<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method private-instance' id='method-method-i-init_patterns'>
<a name='method-i-init_patterns'></a>
<div class='synopsis'>
<span class='name'>init_patterns</span><span class='arguments'>()</span>

</div>
<div class='description'>

<p>Builds the list of init function patterns for the model.</p>

<p>@return [Array&lt;Regexp&gt;]</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-init_patterns-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-init_patterns-source'><span class="ruby-comment"># File lib/chroma_wave/driver_extraction/source_parser/init_sequence_parsing.rb, line 33</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">init_patterns</span>
  <span class="ruby-identifier">escaped</span> = <span class="ruby-constant">Regexp</span>.<span class="ruby-identifier">escape</span>(<span class="ruby-ivar">@prefix</span>)
  <span class="ruby-identifier">patterns</span> = [
    <span class="ruby-regexp">/#{escaped}_Init\b(?!_Fast|_Part|_Partial|_4Gray|_4GRAY|_GUI)/</span>,
    <span class="ruby-regexp">/#{escaped}_?Init\b(?!_Fast|_Part|_Partial|_4Gray|_4GRAY|_GUI)/</span>
  ]
  <span class="ruby-identifier">patterns</span>.<span class="ruby-identifier">unshift</span>(<span class="ruby-regexp">/EPD_3IN7_1Gray_Init/</span>) <span class="ruby-keyword">if</span> <span class="ruby-ivar">@model_name</span> <span class="ruby-operator">==</span> <span class="ruby-string">&#39;EPD_3in7&#39;</span>
  <span class="ruby-identifier">patterns</span>
<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method private-instance' id='method-method-i-partial_init_patterns'>
<a name='method-i-partial_init_patterns'></a>
<div class='synopsis'>
<span class='name'>partial_init_patterns</span><span class='arguments'>()</span>

</div>
<div class='description'>

<p>Builds the list of partial init function patterns.</p>

<p>@return [Array&lt;Regexp&gt;]</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-partial_init_patterns-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-partial_init_patterns-source'><span class="ruby-comment"># File lib/chroma_wave/driver_extraction/source_parser/init_sequence_parsing.rb, line 46</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">partial_init_patterns</span>
  <span class="ruby-identifier">escaped</span> = <span class="ruby-constant">Regexp</span>.<span class="ruby-identifier">escape</span>(<span class="ruby-ivar">@prefix</span>)
  [<span class="ruby-regexp">/#{escaped}_?Init_Partial/</span>, <span class="ruby-regexp">/#{escaped}_?Part_Init/</span>, <span class="ruby-regexp">/#{escaped}_?Init_Part/</span>]
<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method private-instance' id='method-method-i-skip_init_line-3F'>
<a name='method-i-skip_init_line-3F'></a>
<div class='synopsis'>
<span class='name'>skip_init_line?</span><span class='arguments'>(stripped)</span>

</div>
<div class='description'>

<p>Determines whether a line should be skipped during init parsing.</p>

<p>@param stripped [String] stripped line content @return [Boolean]</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-skip_init_line-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-skip_init_line-3F-source'><span class="ruby-comment"># File lib/chroma_wave/driver_extraction/source_parser/init_sequence_parsing.rb, line 84</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">skip_init_line?</span>(<span class="ruby-identifier">stripped</span>)
  <span class="ruby-identifier">stripped</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">stripped</span>.<span class="ruby-identifier">start_with?</span>(<span class="ruby-string">&#39;//&#39;</span>) <span class="ruby-operator">||</span>
    <span class="ruby-identifier">stripped</span>.<span class="ruby-identifier">match?</span>(<span class="ruby-regexp">/^\s*(UWORD|UBYTE|unsigned|static|UDOUBLE|int)\b/</span>) <span class="ruby-operator">||</span>
    <span class="ruby-identifier">stripped</span>.<span class="ruby-identifier">match?</span>(<span class="ruby-regexp">/^\s*Debug\b/</span>)
<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method private-instance' id='method-method-i-sw_reset_context-3F'>
<a name='method-i-sw_reset_context-3F'></a>
<div class='synopsis'>
<span class='name'>sw_reset_context?</span><span class='arguments'>(remaining_lines)</span>

</div>
<div class='description'>

<p>Determines whether a 0x12 command is a software reset.</p>

<p>@param remaining_lines [Array&lt;String&gt;] lines after the current one @return [Boolean]</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-sw_reset_context-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-sw_reset_context-3F-source'><span class="ruby-comment"># File lib/chroma_wave/driver_extraction/source_parser/init_sequence_parsing.rb, line 187</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">sw_reset_context?</span>(<span class="ruby-identifier">remaining_lines</span>)
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">true</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">remaining_lines</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">remaining_lines</span>.<span class="ruby-identifier">empty?</span>

  <span class="ruby-identifier">remaining_lines</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">line</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">result</span> = <span class="ruby-identifier">classify_sw_reset_line</span>(<span class="ruby-identifier">line</span>.<span class="ruby-identifier">strip</span>)
    <span class="ruby-keyword">return</span> <span class="ruby-identifier">result</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">result</span>.<span class="ruby-identifier">nil?</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">true</span>
<span class="ruby-keyword">end</span></pre>
</div>
</div>
</div>
</div>

</div>
</div>

<div id='footer-push'></div>
</div>
<div id='footer'>
<a href="https://github.com/jeremyevans/hanna"><strong>Hanna</strong> RDoc template</a>
</div>
</body>
</html>
