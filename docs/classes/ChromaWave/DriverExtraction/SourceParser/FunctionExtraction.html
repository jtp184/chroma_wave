<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang='en'>
<head>
<title>ChromaWave::DriverExtraction::SourceParser::FunctionExtraction</title>
<meta name='viewport' content='width=device-width, initial-scale=1'>
<meta content='text/html; charset=UTF-8' http-equiv='Content-Type'>
<link href='../../../../css/style.css' media='screen' rel='stylesheet' type='text/css'>
<script type='text/javascript'>
  function popupCode(url) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }
  
  function toggleCode(id) {
    var code = document.getElementById(id)
  
    code.style.display = code.style.display != 'block' ? 'block' : 'none'
    return true
  }
  
  // Make codeblocks hidden by default
  document.writeln('<' + 'style type="text/css">.method .source pre { display: none }<\/style>')
</script>
</head>
<body class='page'>
<div class='class' id='wrapper'>
<div class='header'>
<h1 class='name'><span class='type'>module</span>
ChromaWave::DriverExtraction::SourceParser::FunctionExtraction
</h1>
<ol class='paths'>
<li>
<a href="../../../../files/lib/chroma_wave/driver_extraction/source_parser/function_extraction_rb.html">lib/chroma_wave/driver_extraction/source_parser/function_extraction.rb</a>
</li>
</ol>
</div>
<div id='content'>
<div id='text'>
<div id='description'>
<p>Helpers for extracting C function bodies from vendor source code.</p>

<p>Provides brace-delimited block extraction and function signature matching, shared by {InitSequenceParsing} and {SignalExtraction}.</p>
</div>
<div id='method-list'>
<h2>Methods</h2>
<h3>Private Instance</h3>
<ol>
<li><a href="#method-i-extract_brace_block">extract_brace_block</a></li>
<li><a href="#method-i-extract_function_body">extract_function_body</a></li>
<li><a href="#method-i-function_signature_pattern">function_signature_pattern</a></li>
</ol>
</div>
<div id='context'>
</div>
<div id='section'>
<div id='methods'>
<h2>Private Instance methods</h2>
<div class='method private-instance' id='method-method-i-extract_brace_block'>
<a name='method-i-extract_brace_block'></a>
<div class='synopsis'>
<span class='name'>extract_brace_block</span><span class='arguments'>(content, start_idx)</span>

</div>
<div class='description'>

<p>Extracts a brace-delimited block starting at the given index.</p>

<p>@param content [String] source text @param start_idx [Integer] index just past the opening brace @return [String] block contents</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-extract_brace_block-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-extract_brace_block-source'><span class="ruby-comment"># File lib/chroma_wave/driver_extraction/source_parser/function_extraction.rb, line 26</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">extract_brace_block</span>(<span class="ruby-identifier">content</span>, <span class="ruby-identifier">start_idx</span>)
  <span class="ruby-identifier">depth</span> = <span class="ruby-value">1</span>
  <span class="ruby-identifier">idx</span> = <span class="ruby-identifier">start_idx</span>

  <span class="ruby-keyword">while</span> <span class="ruby-identifier">idx</span> <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">content</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">depth</span>.<span class="ruby-identifier">positive?</span>
    <span class="ruby-keyword">case</span> <span class="ruby-identifier">content</span>[<span class="ruby-identifier">idx</span>]
    <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;{&#39;</span> <span class="ruby-keyword">then</span> <span class="ruby-identifier">depth</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
    <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;}&#39;</span> <span class="ruby-keyword">then</span> <span class="ruby-identifier">depth</span> <span class="ruby-operator">-=</span> <span class="ruby-value">1</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">idx</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">content</span>[<span class="ruby-identifier">start_idx</span><span class="ruby-operator">...</span>(<span class="ruby-identifier">idx</span> <span class="ruby-operator">-</span> <span class="ruby-value">1</span>)]
<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method private-instance' id='method-method-i-extract_function_body'>
<a name='method-i-extract_function_body'></a>
<div class='synopsis'>
<span class='name'>extract_function_body</span><span class='arguments'>(content, name_pattern)</span>

</div>
<div class='description'>

<p>Extracts the body of a C function matching the given pattern.</p>

<p>@param content [String] full C source @param name_pattern [Regexp] function name pattern to match @return [String, nil] function body text or nil</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-extract_function_body-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-extract_function_body-source'><span class="ruby-comment"># File lib/chroma_wave/driver_extraction/source_parser/function_extraction.rb, line 46</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">extract_function_body</span>(<span class="ruby-identifier">content</span>, <span class="ruby-identifier">name_pattern</span>)
  <span class="ruby-identifier">match</span> = <span class="ruby-identifier">content</span>.<span class="ruby-identifier">match</span>(<span class="ruby-identifier">function_signature_pattern</span>(<span class="ruby-identifier">name_pattern</span>))
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">nil</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">match</span>

  <span class="ruby-identifier">extract_brace_block</span>(<span class="ruby-identifier">content</span>, <span class="ruby-identifier">match</span>.<span class="ruby-identifier">end</span>(<span class="ruby-value">0</span>))
<span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method private-instance' id='method-method-i-function_signature_pattern'>
<a name='method-i-function_signature_pattern'></a>
<div class='synopsis'>
<span class='name'>function_signature_pattern</span><span class='arguments'>(name_pattern)</span>

</div>
<div class='description'>

<p>Builds a regex to match a C function signature.</p>

<p>@param name_pattern [Regexp] function name pattern @return [Regexp]</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-function_signature_pattern-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-function_signature_pattern-source'><span class="ruby-comment"># File lib/chroma_wave/driver_extraction/source_parser/function_extraction.rb, line 17</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">function_signature_pattern</span>(<span class="ruby-identifier">name_pattern</span>)
  <span class="ruby-regexp">/(?:static\s+)?(?:void|UBYTE|int)\s+(#{name_pattern.source})\s*\([^)]*\)\s*\{/m</span>
<span class="ruby-keyword">end</span></pre>
</div>
</div>
</div>
</div>

</div>
</div>

<div id='footer-push'></div>
</div>
<div id='footer'>
<a href="https://github.com/jeremyevans/hanna"><strong>Hanna</strong> RDoc template</a>
</div>
</body>
</html>
